{"ast":null,"code":"import _toConsumableArray from\"/Users/mspolermo/git/sultan-web-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/mspolermo/git/sultan-web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useMemo,useState}from'react';import goods from'./goods/goods.json';import'./App.css';import Catalog from'./pages/Catalog';import ProductCard from'./pages/ProductCard';import Basket from'./pages/Basket';import{BrowserRouter,Route,Routes}from'react-router-dom';import{NavLink}from'react-router-dom';import Header from'./components/Header';import AdminPage from'./pages/AdminPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),productType=_useState2[0],setProductType=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),orderList=_useState4[0],setOrderList=_useState4[1];useEffect(function(){if(productType!==undefined&&productType!==''){//Добавляем товар из списка\nif(!orderList.includes(goods[+productType-1])){setOrderList([].concat(_toConsumableArray(orderList),[goods[+productType-1]]));setSumOfMoneyArray([].concat(_toConsumableArray(sumOfMoneyArray),[[goods[+productType-1].id,1]]));}else{//Если он уже добавлен 1 раз в корзину\nvar array=sumOfMoneyArray;var foundIndex=-1;var foundProductId=goods[+productType-1].id;var foundProductValue;for(var i=0;i<array.length;i++){if(array[i][0]==goods[+productType-1].id){foundIndex=i;foundProductValue=array[i][1];}}array.splice(foundIndex,1);setSumOfMoneyArray([].concat(_toConsumableArray(array),[[foundProductId,foundProductValue+1]]));}setProductType(undefined);}},[productType]);var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),orderThing=_useState6[0],setOrderThing=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),sumOfMoneyArray=_useState8[0],setSumOfMoneyArray=_useState8[1];useEffect(function(){//Подсчет суммы товаров в корзине (при измения количества товаров)  \nif(orderThing!==undefined){var array=sumOfMoneyArray;var findIndex=-1;for(var i=0;i<array.length;i++){if(array[i][0]==orderThing[0]){findIndex=i;}}array.splice(findIndex,1);setSumOfMoneyArray([].concat(_toConsumableArray(array),[orderThing]));}},[orderThing]);var finalPrice=useMemo(function(){var result=0;for(var i=0;i<sumOfMoneyArray.length;i++){result+=goods[sumOfMoneyArray[i][0]-1].price*sumOfMoneyArray[i][1];}return result;},[sumOfMoneyArray]);var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),removeThing=_useState10[0],setRemoveThing=_useState10[1];useMemo(function(){var index=orderList.findIndex(function(order){return order.id===(removeThing===null||removeThing===void 0?void 0:removeThing.id);});if(index!==-1){orderList.splice(index,1);setOrderList(orderList);}if(orderList.length!==sumOfMoneyArray.length){var array=sumOfMoneyArray;var findIndex=-1;for(var i=0;i<array.length;i++){if(array[i][0]==(removeThing===null||removeThing===void 0?void 0:removeThing.id)){findIndex=i;}}array.splice(findIndex,1);setSumOfMoneyArray(_toConsumableArray(array));}},[removeThing]);return/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(NavLink,{to:\"/\",children:\"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/basket\",children:\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/admin\",children:\"\\u0410\\u0434\\u043C\\u0438\\u043D\\u043A\\u0430\"}),/*#__PURE__*/_jsx(Header,{finalPrice:finalPrice,productTypeValue:productType,onProductTypeChange:setProductType})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Catalog,{goods:goods,productTypeValue:productType,onProductTypeChange:setProductType})}),/*#__PURE__*/_jsx(Route,{path:\"/catalog/:id\",element:/*#__PURE__*/_jsx(ProductCard,{goods:goods,productTypeValue:productType,onProductTypeChange:setProductType})}),/*#__PURE__*/_jsx(Route,{path:\"/basket\",element:/*#__PURE__*/_jsx(Basket,{orderList:orderList,onOrderThingChange:setOrderThing,onRemove:setRemoveThing,finalPrice:finalPrice,basketThingsArray:sumOfMoneyArray})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminPage,{})})]})})]});}export default App;","map":{"version":3,"names":["React","useEffect","useMemo","useState","goods","Catalog","ProductCard","Basket","BrowserRouter","Route","Routes","NavLink","Header","AdminPage","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","productType","setProductType","_useState3","_useState4","orderList","setOrderList","undefined","includes","concat","_toConsumableArray","setSumOfMoneyArray","sumOfMoneyArray","id","array","foundIndex","foundProductId","foundProductValue","i","length","splice","_useState5","_useState6","orderThing","setOrderThing","_useState7","_useState8","findIndex","finalPrice","result","price","_useState9","_useState10","removeThing","setRemoveThing","index","order","children","to","productTypeValue","onProductTypeChange","path","element","onOrderThingChange","onRemove","basketThingsArray"],"sources":["/Users/mspolermo/git/sultan-web-app/src/App.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport goods from './goods/goods.json'\nimport './App.css'\n\nimport Catalog from './pages/Catalog';\nimport ProductCard from './pages/ProductCard';\nimport Basket from './pages/Basket';\nimport { BrowserRouter, Route, Routes } from 'react-router-dom';\nimport { NavLink } from 'react-router-dom';\nimport Header from './components/Header';\nimport { IGoods } from './types/types';\nimport AdminPage from './pages/AdminPage';\n\ninterface goods {\n  goods: IGoods[];\n}\n\n\nfunction App() {\n\n  const [productType, setProductType] = useState<undefined | string>('');\n  const [orderList, setOrderList] = useState<any>([])\n\n  useEffect(() => {\n    \n    if ((productType!== undefined) && (productType!=='') ) {\n      \n    //Добавляем товар из списка\n      if (!orderList.includes(goods[+productType - 1])) {\n        setOrderList([...orderList, goods[+productType - 1]]);\n        setSumOfMoneyArray([...sumOfMoneyArray, [goods[+productType - 1].id, 1]])\n      } else {\n    //Если он уже добавлен 1 раз в корзину\n        \n        let array = sumOfMoneyArray;\n        let foundIndex: number = -1;\n        let foundProductId = goods[+productType - 1].id;\n        let foundProductValue;\n  \n        for( let i=0; i<array.length; i++) {\n          if ((array[i])[0] == goods[+productType - 1].id) {\n            foundIndex = i;\n            foundProductValue = (array[i])[1]\n          }\n        }\n        array.splice(foundIndex, 1)\n        setSumOfMoneyArray([...array, [foundProductId, foundProductValue + 1] ])\n      }\n      setProductType(undefined)\n    }\n  }, [productType]);  \n\n  const [orderThing, setOrderThing] = useState<undefined | Array<number>>();\n  const [sumOfMoneyArray, setSumOfMoneyArray] = useState <any>([])\n  useEffect(() => { \n    //Подсчет суммы товаров в корзине (при измения количества товаров)  \n    if (orderThing!==undefined) {\n      let array = sumOfMoneyArray;\n      let findIndex: number = -1;\n\n      for( let i=0; i<array.length; i++) {\n        if ((array[i])[0] == orderThing[0]) {\n          findIndex = i;\n        }\n      }\n      array.splice(findIndex, 1)\n      setSumOfMoneyArray([...array, orderThing])\n    }\n  }, [orderThing])\n  const finalPrice = useMemo (() => {\n    let result = 0;\n      for (let i=0; i<sumOfMoneyArray.length; i++) {\n        result+= (goods[(sumOfMoneyArray[i][0])-1].price * (sumOfMoneyArray[i])[1])\n      }\n    return result  \n  }, [sumOfMoneyArray])\n\n  const [removeThing, setRemoveThing] = useState<undefined | IGoods>();\n  useMemo(() => {\n\n    let index = orderList.findIndex ( (order:any) => order.id === removeThing?.id)\n\n    if (index!== -1) {\n      orderList.splice(index, 1);\n      \n      setOrderList(orderList)\n    }\n    if (orderList.length !== sumOfMoneyArray.length) {\n      let array = sumOfMoneyArray;\n      let findIndex: number = -1;\n\n      for( let i=0; i<array.length; i++) {\n        if ((array[i])[0] == removeThing?.id) {\n          findIndex = i;\n        }\n      }\n      array.splice(findIndex, 1)\n      setSumOfMoneyArray([...array])\n    }\n  }, [removeThing])\n\n  return (\n    <BrowserRouter>\n      <div>\n        <NavLink to=\"/\">Каталог товаров</NavLink>\n        <NavLink to=\"/basket\">Корзина</NavLink>\n        <NavLink to=\"/admin\">Админка</NavLink>\n        <Header \n            finalPrice={finalPrice}\n            productTypeValue={productType}\n            onProductTypeChange={setProductType}        \n        />\n      </div>\n      <div>\n        <Routes>\n          <Route path='/' element={<Catalog\n            goods={goods} \n            productTypeValue={productType}\n            onProductTypeChange={setProductType}          \n          />}></Route>\n          <Route path='/catalog/:id' element={<ProductCard\n            goods={goods} \n            productTypeValue={productType}\n            onProductTypeChange={setProductType}\n          />}></Route>\n          <Route path='/basket' element={<Basket\n            orderList={orderList}\n            onOrderThingChange={setOrderThing}\n            onRemove={setRemoveThing}\n            finalPrice={finalPrice}\n            basketThingsArray={sumOfMoneyArray} \n          />}></Route>\n          <Route path='/admin' element={<AdminPage />}></Route>\n        </Routes>\n      </div>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}